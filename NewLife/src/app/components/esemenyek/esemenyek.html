<!-- Page Header -->
<section class="page-header">
  <app-bubbles></app-bubbles>
  <div class="container">
    <h1 animateOnScroll="fadeInDown" [animationDelay]="200">EsemÃ©nyek</h1>
    <p animateOnScroll="fadeInUp" [animationDelay]="400">GyÃ¼lekezeti alkalmaink Ã©s programjaink</p>
  </div>
</section>

<!-- Recurring Events Section -->
<section class="section recurring-events-section">
  <div class="container">
    <h2 class="text-center mb-3" animateOnScroll="fadeInDown" [animationDelay]="200">Rendszeres alkalmaink</h2>
    
    
    <div class="recurring-events-grid">
      <!-- Sunday Service -->
      <div class="recurring-event-card featured" animateOnScroll="bounceIn" [animationDelay]="300">
        <div class="event-icon">â›ª</div>
        <div class="event-info">
          <h3>VasÃ¡rnapi istentisztelet</h3>
          <div class="event-time">
            <span class="day">VasÃ¡rnap</span>
            <span class="time">10:00</span>
          </div>
          <p>KÃ¶zÃ¶s imÃ¡dat, ige Ã©s Ãºrvacsora minden vasÃ¡rnap reggel</p>
          <div class="event-location">
            <span>ğŸ“ GyÃ¼lekezeti terem</span>
          </div>
        </div>
      </div>

      <!-- Bible Study -->
      <div class="recurring-event-card" animateOnScroll="bounceIn" [animationDelay]="500">
        <div class="event-icon">ğŸ“–</div>
        <div class="event-info">
          <h3>BibliaÃ³ra</h3>
          <div class="event-time">
            <span class="day">Szerda</span>
            <span class="time">19:00</span>
          </div>
          <p>KÃ¶zÃ¶s bibliatanulmÃ¡nyozÃ¡s Ã©s beszÃ©lgetÃ©s</p>
          <div class="event-location">
            <span>ğŸ“ GyÃ¼lekezeti terem</span>
          </div>
        </div>
      </div>

      <!-- Prayer Meeting -->
      <div class="recurring-event-card" animateOnScroll="bounceIn" [animationDelay]="700">
        <div class="event-icon">ğŸ™</div>
        <div class="event-info">
          <h3>ImaÃ³ra</h3>
          <div class="event-time">
            <span class="day">PÃ©ntek</span>
            <span class="time">18:30</span>
          </div>
          <p>KÃ¶zÃ¶s ima Ã©s kÃ¶zbenjÃ¡rÃ¡s</p>
          <div class="event-location">
            <span>ğŸ“ GyÃ¼lekezeti terem</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Upcoming Events Section -->
<section class="section upcoming-events-section">
  <div class="container">
    <h2 class="text-center mb-3" animateOnScroll="fadeInDown" [animationDelay]="200">KÃ¶zelgÅ‘ esemÃ©nyek</h2>
    
    
    <!-- Events List -->
    <div class="upcoming-events-list">
      <!-- Dynamic Events from Firebase -->
      <div *ngFor="let event of getUpcomingEvents(); trackBy: trackByEventId; let i = index" 
           class="upcoming-event-card" 
           [class.featured]="event.type === 'service'"
           [class.special]="event.type === 'special'"
           (click)="openEventModal(event)"
           animateOnScroll="slideInLeft" 
           [animationDelay]="i * 200 + 500">
        
        <div class="event-date-time">
          <div class="event-date">
            <span class="month">{{ getEventMonth(event.date) }}</span>
            <span class="day">{{ getEventDay(event.date) }}</span>
          </div>
          <div class="event-time">
            <span class="time">{{ getEventTime(event.date) }}</span>
            <span class="weekday">{{ getEventWeekday(event.date) }}</span>
          </div>
        </div>
        
        <div class="event-content">
          <div class="event-header">
            <h3>{{ event.title }}</h3>
            <span class="event-type">{{ getEventTypeIcon(event.type) }} {{ getEventTypeText(event.type) }}</span>
          </div>
          <p class="event-description" [innerHTML]="event.description"></p>
          <div class="event-location">
            <span>ğŸ“ {{ event.location }}</span>
          </div>
        </div>
        
        <div class="event-actions">
          <button 
            class="btn btn-calendar"
            (click)="addToGoogleCalendar(event); $event.stopPropagation()"
            title="HozzÃ¡adÃ¡s Google NaptÃ¡rhoz">
            ğŸ“… NaptÃ¡rhoz
          </button>
          <button 
            *ngIf="event.id"
            [class]="getAttendanceButtonClass(event.id)"
            (click)="toggleAttendance(event); $event.stopPropagation()"
            [disabled]="isLoading()">
            {{ getAttendanceButtonText(event.id) }}
          </button>
          <span class="attendance-count" *ngIf="event.id">
            {{ getAttendanceCount(event.id) }} jelÃ¶lte meg
          </span>
        </div>
      </div>

      <!-- No Events Message -->
      <div *ngIf="getUpcomingEvents().length === 0" class="no-upcoming-events" animateOnScroll="fadeInUp" [animationDelay]="600">
        <div class="no-events-icon">ğŸ“…</div>
        <h3>Jelenleg nincsenek kÃ¼lÃ¶nleges esemÃ©nyek</h3>
        <p>A rendszeres alkalmaink tovÃ¡bbra is vÃ¡rnak minden hÃ©ten!</p>
        <p class="note">Firebase kapcsolÃ³dÃ¡s utÃ¡n itt jelennek meg a kÃ¼lÃ¶nleges esemÃ©nyek.</p>
      </div>
    </div>
  </div>
</section>

<!-- Info Section -->
<section class="section info-section">
  <div class="container">
    <div class="info-content">
      <h2 animateOnScroll="fadeInDown" [animationDelay]="200">TovÃ¡bbi informÃ¡ciÃ³k</h2>
      <div class="info-cards">
        <div class="info-card" animateOnScroll="slideInLeft" [animationDelay]="300">
          <h4>ğŸ“ HelyszÃ­n</h4>
          <p><strong>GyÃ¶ngyÃ¶s</strong><br>
          <strong>PÃ¡ter Kiss SzalÃ©z u. 14</strong><br>
          ParkolÃ¡si lehetÅ‘sÃ©g az Ã©pÃ¼let mellett</p>
        </div>
        
        <div class="info-card" animateOnScroll="zoomIn" [animationDelay]="500">
          <h4>ğŸ‘¥ KÃ¶zÃ¶ssÃ©g</h4>
          <p>Szeretettel vÃ¡runk minden korosztÃ¡lyt! GyermekfelÃ¼gyelet biztosÃ­tott a vasÃ¡rnapi istentiszteletek alatt.</p>
        </div>
        
        <div class="info-card" animateOnScroll="slideInRight" [animationDelay]="700">
          <h4>ğŸ“ Kapcsolat</h4>
          <p>KÃ©rdÃ©seid esetÃ©n keress minket bizalommal! SzÃ­vesen segÃ­tÃ¼nk Ã©s tÃ¡jÃ©koztatunk.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Event Modal -->
<div *ngIf="showEventModal()" class="modal-overlay" (click)="closeEventModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="event-meta-header">
        <div class="event-date-full">{{ formatEventDate(selectedEvent()!.date) }}</div>
        <span class="event-type">
          {{ getEventTypeIcon(selectedEvent()!.type) }} {{ getEventTypeText(selectedEvent()!.type) }}
        </span>
      </div>
      <button class="close-btn" (click)="closeEventModal()">âœ•</button>
    </div>
    
    <div class="modal-body">
      <h1>{{ selectedEvent()!.title }}</h1>
      <div class="event-location-full">ğŸ“ {{ selectedEvent()!.location }}</div>
      
      <div class="event-details">
        <img *ngIf="selectedEvent()?.imageUrl" 
             [lazyImg]="selectedEvent()!.imageUrl!" 
             [alt]="selectedEvent()!.title"
             class="event-image"
             (error)="onImageError($event)">
        
        <div class="event-description-full" [innerHTML]="selectedEvent()!.description"></div>
        
                 <div class="event-attendance-section" *ngIf="selectedEvent()!.id">
           <div class="attendance-info">
             <h3>RÃ©szvÃ©tel</h3>
             <p>{{ getAttendanceCount(selectedEvent()!.id!) }} fÅ‘ jelÃ¶lte meg, hogy rÃ©szt vesz ezen az esemÃ©nyen.</p>
           </div>
           
           <div class="attendance-actions">
             <button 
               class="btn btn-calendar"
               (click)="addToGoogleCalendar(selectedEvent()!)"
               title="HozzÃ¡adÃ¡s Google NaptÃ¡rhoz">
               ğŸ“… HozzÃ¡adÃ¡s Google NaptÃ¡rhoz
             </button>
             <button 
               [class]="getAttendanceButtonClass(selectedEvent()!.id!)"
               (click)="toggleAttendance(selectedEvent()!)"
               [disabled]="isLoading()">
               {{ getAttendanceButtonText(selectedEvent()!.id!) }}
             </button>
           </div>
         </div>
      </div>
    </div>
  </div>
</div>
